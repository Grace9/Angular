!function(e){e.module("moviecat",["moviecat_home","moviecat_details","moviecat_movie_list","heima"]).controller("searchCtrl",["$scope","$window",function(e,o){e.query=function(){o.location.hash="#/search?q="+e.keyword}}])}(angular),function(e){var o=e.module("moviecat_details",["ngRoute","heima"]);o.config(["$routeProvider",function(e){e.when("/details/:id",{templateUrl:"./views/details.html",controller:"detailsController"})}]),o.controller("detailsController",["$scope","$routeParams","heimaJsonp",function(e,o,t){e.isShow=!0;var a=o.id;t.jsonp({url:"http://api.douban.com/v2/movie/subject/"+a,params:{},callback:function(o){e.movie=o,e.isShow=!1,e.$apply()}})}])}(angular),function(e){var o=e.module("moviecat_home",["ngRoute"]);o.config(["$locationProvider",function(e){e.hashPrefix("")}]),o.config(["$routeProvider",function(e){e.when("/home",{templateUrl:"./views/home.html"}).when("/",{redirectTo:"/home"})}])}(angular),function(e){var o=e.module("moviecat_movie_list",["ngRoute","heima"]);o.config(["$routeProvider",function(e){e.when("/:type/:page?",{templateUrl:"./views/movie_list.html",controller:"movie_listController"})}]),o.controller("movie_listController",["$scope","$route","$routeParams","heimaJsonp","$window",function(e,o,t,a,i){e.isShow=!0,e.pageSize=10,e.pageIndex=(t.page||"1")-0,a.jsonp({url:"http://api.douban.com/v2/movie/"+t.type,params:{count:e.pageSize,start:(e.pageIndex-1)*e.pageSize,q:t.q},callback:function(o){e.movies=o,e.pageCount=i.Math.ceil(o.total/e.pageSize),e.isShow=!1,e.$apply()}}),e.getPage=function(t){t<1||t>e.pageCount||o.updateParams({page:t})}}])}(angular),function(e){var o=e.module("heima",[]);o.service("heimaJsonp",["$window",function(e){this.jsonp=function(o){var t=o.url+="?";for(var a in o.params)t+=a+"="+o.params[a]+"&";var i="jsonp_"+e.Math.random().toString().slice(2);e[i]=o.callback,t+="callback="+i;var n=e.document.createElement("script");n.src=t,e.document.body.appendChild(n)}}]),o.directive("hmActive",[function(){return{restrict:"A",link:function(e,o,t){o.on("click",function(){o.parent().children().removeClass("active"),o.addClass("active")})}}}])}(angular);